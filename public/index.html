<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>PokeQuant v0.7.2</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="/styles.css?v=0.7.2" />
  </head>
  <body>
  <a href="#mainContent" style="position:absolute;left:-999px;top:auto;width:1px;height:1px;overflow:hidden" onfocus="this.style.cssText='position:absolute;left:8px;top:8px;background:#162132;color:#e5ecf5;padding:6px 10px;border:1px solid #253349;border-radius:6px;z-index:500'" onblur="this.style.left='-999px'">Skip to content</a>
  <!-- Deployment banner removed post verification -->
  <div id="srLive" aria-live="polite" style="position:absolute;left:-999px;height:1px;width:1px;overflow:hidden"></div>
    <div id="toastHost" style="position:fixed;top:46px;right:14px;display:flex;flex-direction:column;gap:8px;z-index:400"></div>
    <div id="statusBanner" style="position:fixed;top:24px;left:50%;transform:translateX(-50%);background:#162132;color:#e5ecf5;font-size:11px;padding:6px 10px;border:1px solid #253349;border-radius:8px;display:none;z-index:380"></div>
    <div class="app-shell">
      <aside class="sidebar">
        <div class="brand"><div class="brand-badge"></div> PokeQuant <span style="font-size:10px;opacity:.55" id="appVersion"></span></div>
        <button id="themeToggle" style="font-size:11px;padding:6px 10px;border:1px solid #253349;background:#162132;color:#e5ecf5;border-radius:8px;cursor:pointer">ðŸŒ™</button>
        <nav class="nav" aria-label="Primary">
          <button data-view="overview" class="active" aria-current="page">Overview</button>
          <button data-view="cards">Cards</button>
        </nav>
        <div style="margin-top:auto;font-size:10px;opacity:.55;line-height:1.4">Prototype UI. Not investment advice.</div>
      </aside>
      <div class="main">
        <div class="topbar">
          <div style="font-weight:600;letter-spacing:.5px" id="currentViewLabel">Overview</div>
          <div class="grow"></div>
          <input id="globalSearch" placeholder="Search cardsâ€¦" aria-label="Search cards" style="background:#162132;border:1px solid #253349;color:#e5ecf5;font-size:12px;padding:6px 10px;border-radius:8px;min-width:240px" />
        </div>
        <div style="padding:26px 26px 60px;display:flex;flex-direction:column;gap:40px">
          <section data-panel="overview" class="fade-in" style="display:flex;flex-direction:column;gap:34px">
            <div class="panel">
              <h2>Top Movers</h2>
              <div id="moversUp" class="grid-tiles"></div>
            </div>
            <div class="panel">
              <h2>Biggest Losers</h2>
              <div id="moversDown" class="grid-tiles"></div>
            </div>
            <div class="panel">
              <h2>System Health</h2>
              <div id="healthInfo" style="font-size:12px;opacity:.75">Loading healthâ€¦</div>
            </div>
            <div class="panel" id="alertPanel">
              <h2>Create Alert (Quick)</h2>
              <form id="alertQuickForm" style="display:flex;flex-wrap:wrap;gap:10px;align-items:flex-end;font-size:12px">
                <label style="display:flex;flex-direction:column;gap:4px">Email <input required name="email" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:6px 8px;border-radius:6px;width:190px" /></label>
                <label style="display:flex;flex-direction:column;gap:4px">Card ID <input required name="card_id" placeholder="e.g. card123" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:6px 8px;border-radius:6px;width:140px" /></label>
                <label style="display:flex;flex-direction:column;gap:4px">Kind
                  <select name="kind" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:6px 8px;border-radius:6px">
                    <option value="above">above</option>
                    <option value="below">below</option>
                  </select>
                </label>
                <label style="display:flex;flex-direction:column;gap:4px">Threshold
                  <input required name="threshold" type="number" step="0.01" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:6px 8px;border-radius:6px;width:110px" />
                </label>
                <label style="display:flex;flex-direction:column;gap:4px">Snooze (min)
                  <input name="snooze" type="number" step="1" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:6px 8px;border-radius:6px;width:90px" />
                </label>
                <button type="submit" style="background:#6366f1;border:1px solid #6366f1;color:#fff;padding:8px 14px;border-radius:8px;cursor:pointer;font-weight:600;letter-spacing:.5px">Create</button>
              </form>
              <div id="alertQuickResult" style="margin-top:10px;font-size:11px;opacity:.75"></div>
            </div>
            <div class="panel" id="alertAdminPanel">
              <h2>Alerts (Admin)</h2>
              <form id="alertAdminFilters" style="display:flex;flex-wrap:wrap;gap:8px;font-size:11px;margin-bottom:10px">
                <label style="display:flex;flex-direction:column;gap:4px">Email <input name="email" placeholder="filter email" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:5px 6px;border-radius:6px;width:170px" /></label>
                <label style="display:flex;flex-direction:column;gap:4px">Active
                  <select name="active" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:5px 6px;border-radius:6px;width:100px">
                    <option value="">(any)</option>
                    <option value="1">Active</option>
                    <option value="0">Inactive</option>
                  </select>
                </label>
                <label style="display:flex;flex-direction:column;gap:4px">Suppressed
                  <select name="suppressed" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:5px 6px;border-radius:6px;width:120px">
                    <option value="">(any)</option>
                    <option value="1">Suppressed</option>
                    <option value="0">Unsuppressed</option>
                  </select>
                </label>
                <button type="submit" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:7px 12px;border-radius:8px;cursor:pointer;height:40px">Load</button>
                <button type="button" id="alertAdminStatsBtn" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:7px 12px;border-radius:8px;cursor:pointer;height:40px">Stats</button>
              </form>
              <div id="alertAdminStats" style="font-size:11px;opacity:.75;margin-bottom:6px"></div>
              <div style="overflow:auto;border:1px solid #253349;border-radius:10px;max-height:320px">
                <table style="width:100%;border-collapse:collapse;font-size:11px;min-width:780px">
                  <thead style="position:sticky;top:0;background:#101726"><tr>
                    <th style="text-align:left;padding:6px 8px">ID</th>
                    <th style="text-align:left;padding:6px 8px">Email</th>
                    <th style="text-align:left;padding:6px 8px">Card</th>
                    <th style="text-align:left;padding:6px 8px">Kind</th>
                    <th style="text-align:left;padding:6px 8px">Thresh</th>
                    <th style="text-align:left;padding:6px 8px">Active</th>
                    <th style="text-align:left;padding:6px 8px">Suppressed Until</th>
                    <th style="text-align:left;padding:6px 8px">Fired</th>
                    <th style="text-align:left;padding:6px 8px">Actions</th>
                  </tr></thead>
                  <tbody id="alertAdminBody"></tbody>
                </table>
              </div>
              <div style="font-size:10px;opacity:.55;margin-top:6px">Snooze requires manage token (returned on creation). Deactivate may not require token (admin flow).</div>
            </div>
            <div class="panel" id="portfolioPanel">
              <h2>Portfolio Summary</h2>
              <form id="portfolioAuth" style="display:flex;flex-wrap:wrap;gap:10px;font-size:12px;margin-bottom:12px">
                <label style="display:flex;flex-direction:column;gap:4px">ID <input name="pid" placeholder="portfolio id" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:6px 8px;border-radius:6px;width:150px" /></label>
                <label style="display:flex;flex-direction:column;gap:4px">Secret <input name="psec" placeholder="secret" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:6px 8px;border-radius:6px;width:170px" /></label>
                <button type="button" id="portfolioLoadBtn" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:8px 14px;border-radius:8px;cursor:pointer">Load</button>
                <button type="button" id="portfolioRefreshBtn" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:8px 14px;border-radius:8px;cursor:pointer" title="Refresh">â†»</button>
                <button type="button" id="portfolioRotateSecretBtn" style="background:#162132;border:1px solid #7c3aed;color:#e5ecf5;padding:8px 14px;border-radius:8px;cursor:pointer" title="Rotate secret">Rotate Secret</button>
              </form>
              <div id="portfolioSummary" style="font-size:12px;opacity:.75">Enter credentials & load.</div>
              <div id="portfolioLotsMini" style="margin-top:12px;font-size:11px;display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:8px"></div>
              <div id="portfolioCrudSection" style="margin-top:18px;display:none;flex-direction:column;gap:12px">
                <h3 style="margin:0;font-size:14px;font-weight:600">Lots</h3>
                <form id="portfolioAddLotForm" style="display:flex;flex-wrap:wrap;gap:8px;font-size:11px;align-items:flex-end">
                  <label style="display:flex;flex-direction:column;gap:4px">Card ID <input required name="card_id" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:5px 6px;border-radius:6px;width:130px" /></label>
                  <label style="display:flex;flex-direction:column;gap:4px">Qty <input required type="number" step="1" name="qty" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:5px 6px;border-radius:6px;width:80px" /></label>
                  <label style="display:flex;flex-direction:column;gap:4px">Cost USD <input required type="number" step="0.01" name="cost_usd" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:5px 6px;border-radius:6px;width:100px" /></label>
                  <label style="display:flex;flex-direction:column;gap:4px">Acquired <input type="date" name="acquired_at" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:5px 6px;border-radius:6px;width:140px" /></label>
                  <button type="submit" style="background:#6366f1;border:1px solid #6366f1;color:#fff;padding:7px 12px;border-radius:8px;cursor:pointer;font-weight:600">Add Lot</button>
                </form>
                <div style="overflow:auto;border:1px solid #253349;border-radius:10px;max-height:360px">
                  <table id="portfolioLotsTable" style="width:100%;border-collapse:collapse;font-size:11px;min-width:620px">
                    <thead style="position:sticky;top:0;background:#101726">
                      <tr>
                        <th style="text-align:left;padding:6px 8px">Card</th>
                        <th style="text-align:left;padding:6px 8px">Qty</th>
                        <th style="text-align:left;padding:6px 8px">Cost</th>
                        <th style="text-align:left;padding:6px 8px">MV</th>
                        <th style="text-align:left;padding:6px 8px">Unrlzd</th>
                        <th style="text-align:left;padding:6px 8px">Actions</th>
                      </tr>
                    </thead>
                    <tbody id="portfolioLotsBody"></tbody>
                  </table>
                </div>
                <div id="portfolioLotsEmpty" style="font-size:11px;opacity:.6;display:none">No lots yet.</div>
              </div>
              <div id="portfolioTargetsSection" style="margin-top:24px;display:none;flex-direction:column;gap:10px">
                <h3 style="margin:0;font-size:14px;font-weight:600">Factor Targets (Coming Soon)</h3>
                <div style="font-size:11px;opacity:.6">UI placeholder â€“ will allow viewing & editing /portfolio/targets then creating optimization orders.</div>
              </div>
            </div>
            <div class="panel" id="adminMetricsPanel">
              <h2>Admin Metrics (Mini)</h2>
              <form id="adminAuth" style="display:flex;gap:8px;font-size:12px;margin-bottom:8px">
                <input id="adminTokenInput" placeholder="Admin token" style="flex:1;min-width:160px;background:#162132;border:1px solid #253349;color:#e5ecf5;padding:6px 8px;border-radius:6px" />
                <button id="adminTokenSet" type="button" style="background:#162132;border:1px solid #253349;color:#e5ecf5;padding:8px 14px;border-radius:8px;cursor:pointer">Set</button>
              </form>
              <ul id="adminMetricsList" style="list-style:none;padding:0;margin:0;font-size:11px;display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:4px"></ul>
            </div>
            <div class="panel" id="factorAnalyticsPanel">
              <h2 style="display:flex;align-items:center;gap:10px">Factor Analytics <button type="button" id="factorAnalyticsRefresh" style="margin-left:auto;background:#162132;border:1px solid #253349;color:#e5ecf5;padding:6px 10px;border-radius:8px;cursor:pointer;font-size:11px">Refresh</button></h2>
              <div id="factorAnalyticsStatus" style="font-size:11px;opacity:.65;margin-bottom:8px">Set admin token & refresh.</div>
              <div id="factorPerformanceHost" style="overflow:auto;border:1px solid #253349;border-radius:10px;max-height:300px;margin-bottom:14px"></div>
              <div id="factorCorrelationsHost" style="overflow:auto;border:1px solid #253349;border-radius:10px;max-height:260px"></div>
            </div>
          </section>
          <section data-panel="cards" hidden>
            <div class="panel" style="overflow:auto">
              <h2>Cards (sample)</h2>
              <div style="overflow:auto;border:1px solid #253349;border-radius:12px;max-height:520px">
                <table style="width:100%;border-collapse:collapse;font-size:12px;min-width:880px">
                  <thead style="position:sticky;top:0;background:#101726;box-shadow:0 2px 0 0 #253349">
                    <tr>
                      <th style="text-align:left;padding:8px 10px;font-weight:600">Card</th>
                      <th style="text-align:left;padding:8px 10px;font-weight:600">Set</th>
                      <th style="text-align:left;padding:8px 10px;font-weight:600">Rarity</th>
                      <th style="text-align:left;padding:8px 10px;font-weight:600">Price</th>
                      <th style="text-align:left;padding:8px 10px;font-weight:600">Signal</th>
                      <th style="text-align:left;padding:8px 10px;font-weight:600">ID</th>
                    </tr>
                  </thead>
                  <tbody id="cardsTableBody"></tbody>
                </table>
              </div>
              <div id="cardsPager" style="margin-top:10px;font-size:11px;display:flex;align-items:center;gap:8px"></div>
            </div>
          </section>
        </div>
      </div>
    </div>
    <!-- Card side panel -->
  <div id="cardSidePanel" style="position:fixed;top:0;right:0;height:100%;width:0;overflow:hidden;background:#101726;border-left:1px solid #253349;box-shadow:-4px 0 18px -6px rgba(0,0,0,.6);transition:width .3s;z-index:320;display:flex;flex-direction:column" aria-labelledby="cardPanelTitle" role="dialog" aria-modal="false" tabindex="-1">
      <div style="display:flex;align-items:center;gap:10px;padding:14px 16px;border-bottom:1px solid #253349">
        <h3 id="cardPanelTitle" style="margin:0;font-size:14px;font-weight:600;letter-spacing:.5px">Card</h3>
        <div style="flex:1"></div>
        <button id="cardPanelClose" style="background:#162132;border:1px solid #253349;color:#e5ecf5;font-size:11px;padding:4px 10px;border-radius:6px;cursor:pointer">Close</button>
      </div>
      <div id="cardPanelBody" style="padding:16px;overflow:auto;font-size:12px;line-height:1.4"></div>
    </div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha256-4jGoJZ9jUkZOtJ0i0kBWKGZHJ8L7Kr9d5EnYzWx/juE=" crossorigin="anonymous"></script>
  <!-- Modal removed to fix persistent rectangle; will reintroduce later with proper lifecycle -->
  <script type="module" src="/core.js?v=0.7.2"></script>
  <script type="module" src="/movers.js?v=0.7.2"></script>
  <script type="module" src="/toast.js?v=0.7.2"></script>
  <script type="module" src="/theme.js?v=0.7.2"></script>
  <script type="module" src="/health.js?v=0.7.2"></script>
  <script type="module" src="/app-new.js?v=0.7.2"></script>
  </body>
</html>
